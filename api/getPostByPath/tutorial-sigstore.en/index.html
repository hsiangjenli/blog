{"type":"getPostByPath","data":{"title":"[tutorial] Introduction to sigstore's model signing tool","date":"2025-11-05T16:00:00.000Z","description":"<blockquote>\n<p>Note: This page is an AI-generated (gpt-5-mini-2025-08-07) translation from Traditional Chinese and may contain minor inaccuracies.</p>\n</blockquote>\n<h1>üìå Introduction</h1>\n<p>Introducing Sigstore‚Äôs model signing tool and describing how its three-layer structure (Sigstore Bundle, DSSE Envelope, In‚ÄëToto Statement) provides integrity, authenticity, and transparency for machine learning model signing and verification. Also demonstrates simple signing and verification commands.</p>","categories":[],"tags":[{"name":"security","_id":"cmixkzuo10014ng5n6q7g75fv"},{"name":"ai","_id":"cmixkzuod002jng5nhhxl2918"}],"content":"\n    <style>\n    .post-lang-switch{\n      position: absolute;\n      top: .75rem;\n      right: .75rem;\n      z-index: 2;\n      color: var(--link, #3273dc);\n    }\n    .post-lang-switch:hover{opacity:.8}\n    </style>\n  \n    <a class=\"post-lang-switch\" href=\"/blog/zh-TW/tutorial-sigstore/\" title=\"Êü•ÁúãÁπÅÈ´î‰∏≠ÊñáÁâàÊú¨\" aria-label=\"Êü•ÁúãÁπÅÈ´î‰∏≠ÊñáÁâàÊú¨\">\n      <i class=\"fas fa-language\"></i>\n    </a>\n  <blockquote>\n<p>Note: This page is an AI-generated (gpt-5-mini-2025-08-07) translation from Traditional Chinese and may contain minor inaccuracies.</p>\n</blockquote>\n<h1>üìå Introduction</h1>\n<p>Introducing Sigstore‚Äôs model signing tool and describing how its three-layer structure (Sigstore Bundle, DSSE Envelope, In‚ÄëToto Statement) provides integrity, authenticity, and transparency for machine learning model signing and verification. Also demonstrates simple signing and verification commands.</p>\n<span id=\"more\"></span>\n<h1>üöÄ Introducing <code>sigstore/model-transparency</code></h1>\n<!-- The goal is to increase the security of ML models in the supply chain, allowing model integrity and provenance claims to be verified -->\n<ul>\n<li><strong>Model integrity</strong>: Sign models with Sigstore to produce cryptographic hashes that protect model integrity</li>\n<li><strong>Transparency</strong>: Anyone can verify model signatures via Sigstore‚Äôs transparency log Rekor</li>\n<li><strong>Ease of use</strong>: Easier to use than traditional signing mechanisms, and offers an option for keyless signing</li>\n</ul>\n<h2 id=\"Model-signing\">Model signing</h2>\n<h3 id=\"4-main-pain-points\">4 main pain points</h3>\n<ul>\n<li><strong>Integrity</strong>: Ensure the model has not been tampered with during release and is still the original</li>\n<li><strong>Authenticity</strong>: Be able to know who created the model; the source can be trusted and traced</li>\n<li><strong>Security</strong>: Prevent attacks like model or dataset poisoning and unauthorized modifications</li>\n<li><strong>Compliance</strong>: Prove the model adhered to relevant regulations during development and deployment (e.g., not trained on unknown or unauthorized personal data)</li>\n</ul>\n<h3 id=\"Supported-signing-methods\">Supported signing methods</h3>\n<!-- https://github.com/sigstore/model-transparency/blob/36e01a9bd611436b847da633461afcc8f74891c4/README.md?plain=1#L34-L39 -->\n<ul>\n<li><strong>Keyless signing</strong>: Use Sigstore for signing, avoiding complex key generation, storage, and management, and enabling public audit via Rekor</li>\n<li><strong>Traditional keys &amp; certificate signing</strong>: Users manage keys themselves, including raw keys, self-signed certificates, or CA-signed certificates</li>\n<li><strong>Hardware device signing</strong>: Supports signing via the PKCS #11 standard interface, commonly used in finance, government, and other high-security/compliance contexts</li>\n</ul>\n<h3 id=\"Workflow\">Workflow</h3>\n<p>When an ML model is ready for deployment, the system generates cryptographic hashes for the model itself, all internal files, and metadata, and writes them into a manifest. This manifest records the path and corresponding hash for each file, fully describing the contents of the ML repo. The format is also compatible with various metadata (e.g., Model Card), presenting model details in a structured way.</p>\n<h3 id=\"Sigstore-format-signing-process\">Sigstore format &amp; signing process</h3>\n<p><img src=\"https://github.com/sigstore/model-transparency/raw/main/docs/images/model-signing-format-diagram.png\" alt=\"\"></p>\n<h4 id=\"Divided-into-three-layers\">Divided into three layers</h4>\n<ol>\n<li>Outer container: Sigstore Bundle</li>\n<li>DSSE Envelope (Dead Simple Signing)</li>\n<li>Actual model manifest: In-Toto Statement</li>\n</ol>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># https://github.com/sigstore/model-transparency/blob/36e01a9bd611436b847da633461afcc8f74891c4/src/model_signing/_signing/sign_ec_key.py#L82-L127</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Signer</span>(sigstore_pb.Signer):</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot;Signer using an elliptic curve private key.&quot;&quot;&quot;</span></span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"meta\">    @override</span></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">sign</span>(<span class=\"params\">self, payload: signing.Payload</span>) -&gt; signing.Signature:</span><br><span class=\"line\">        raw_payload = json_format.MessageToJson(payload.statement.pb).encode(</span><br><span class=\"line\">            <span class=\"string\">&quot;utf-8&quot;</span></span><br><span class=\"line\">        )</span><br><span class=\"line\"></span><br><span class=\"line\">        raw_signature = intoto_pb.Signature(</span><br><span class=\"line\">            sig=base64.b64encode(</span><br><span class=\"line\">                self._private_key.sign(</span><br><span class=\"line\">                    sigstore_pb.pae(raw_payload),</span><br><span class=\"line\">                    ec.ECDSA(get_ec_key_hash(self._private_key.public_key())),</span><br><span class=\"line\">                )</span><br><span class=\"line\">            ),</span><br><span class=\"line\">            keyid=<span class=\"string\">&quot;&quot;</span>,</span><br><span class=\"line\">        )</span><br><span class=\"line\"></span><br><span class=\"line\">        envelope = intoto_pb.Envelope(</span><br><span class=\"line\">            payload=base64.b64encode(raw_payload),</span><br><span class=\"line\">            payload_type=signing._IN_TOTO_JSON_PAYLOAD_TYPE,</span><br><span class=\"line\">            signatures=[raw_signature],</span><br><span class=\"line\">        )</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> sigstore_pb.Signature(</span><br><span class=\"line\">            bundle_pb.Bundle(</span><br><span class=\"line\">                media_type=sigstore_pb._BUNDLE_MEDIA_TYPE,</span><br><span class=\"line\">                verification_material=self._get_verification_material(),</span><br><span class=\"line\">                dsse_envelope=envelope,</span><br><span class=\"line\">            )</span><br><span class=\"line\">        )</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<ul>\n<li><code>raw_payload</code>: Convert the in-toto statement to JSON (serialize the Payload)</li>\n<li><code>raw_signature</code>: <a href=\"https://github.com/astral-sh/sigstore-models/blob/d0dad407dfe19a35aa24cc1c54054dc9d90ecd0e/src/sigstore_models/intoto.py#L12-L14\">DSSE Signature</a>\n<ul>\n<li><code>sig</code>: Digital signature, an independent cryptographic proof used to confirm the authenticity and integrity of the payload. Generation process: PAE-encode the payload --&gt; sign the PAE result with the private key using ECDSA to produce a signature --&gt; Base64-encode the signature for storage in JSON</li>\n<li><code>keyid</code>: Key identifier. Only one key is used for this signature, so it‚Äôs left empty</li>\n</ul>\n</li>\n<li><code>envelope</code>: DSSE Envelope, contains:\n<ul>\n<li><code>payload</code>: The raw payload Base64-encoded</li>\n<li><code>payload_type</code>: Indicates how the Verifier should parse the payload</li>\n<li><code>signatures</code>: Signature values encoded in Base64</li>\n</ul>\n</li>\n<li><code>sigstore_pb.Signature</code>: Object wrapping the Sigstore Bundle\n<ul>\n<li><code>media_type</code>: Indicates the Sigstore bundle format version so the Verifier knows how to parse the bundle</li>\n<li><code>verification_material</code>: Contains materials needed to verify the signature, varying by signing method</li>\n<li><code>dsse_envelope</code>: DSSE Envelope</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"Verification-process\">Verification process</h3>\n<ol>\n<li>Parse the Sigstore bundle</li>\n<li>Verify the DSSE signature‚Äôs validity</li>\n<li>Extract the predicate from the in-toto statement</li>\n<li>Recompute the model hashes according to the serialization information</li>\n<li>Compare the resources list with the actual computed results</li>\n<li>Verify the global digest matches</li>\n</ol>\n<!-- Use [Sigstore](https://www.sigstore.dev/) for signing. Sigstore makes code signing transparent and removes the need to manage key material, but tools like model_signing also support traditional signing methods such as public/private key signing, signing certificates, or PKCS #11 -->\n<h3 id=\"Hands-on\">Hands-on</h3>\n<h4 id=\"Download-a-model-to-sign\">Download a model to sign</h4>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git clone --depth=1 &quot;https://huggingface.co/bert-base-uncased&quot;</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">Remove .git directory</span></span><br><span class=\"line\">rm -rf bert-base-uncased/.git </span><br></pre></td></tr></table></figure>\n<h4 id=\"Install-model-signing\">Install model_signing</h4>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uv add model_signing</span><br></pre></td></tr></table></figure>\n<h4 id=\"View-model-signing-CLI\">View model_signing CLI</h4>\n<p>There are two modes: <code>sign</code> and <code>verify</code></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uv run model_signing --help  </span><br></pre></td></tr></table></figure>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Usage: model_signing [OPTIONS] COMMAND [ARGS]...</span><br><span class=\"line\"></span><br><span class=\"line\">  ML model signing and verification.</span><br><span class=\"line\"></span><br><span class=\"line\">  Use each subcommand&#x27;s `--help` option for details on each mode.</span><br><span class=\"line\"></span><br><span class=\"line\">Options:</span><br><span class=\"line\">  --version          Show the version and exit.</span><br><span class=\"line\">  --log-level LEVEL  Set the logging level. This can also be set via the</span><br><span class=\"line\">                     MODEL_SIGNING_LOG_LEVEL env var.  [default: INFO]</span><br><span class=\"line\">  -h, --help         Show this message and exit.</span><br><span class=\"line\"></span><br><span class=\"line\">Commands:</span><br><span class=\"line\">  sign    Sign models.</span><br><span class=\"line\">  verify  Verify models.</span><br><span class=\"line\"></span><br><span class=\"line\">  Check https://sigstore.github.io/model-transparency for documentation and</span><br><span class=\"line\">  more details.</span><br></pre></td></tr></table></figure>\n<h4 id=\"Perform-signing\">Perform signing</h4>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uv run model_signing sign bert-base-uncased --signature model.sig</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://hackmd.io/_uploads/Hy4Ih-j1Wl.png\" alt=\"image\"></p>\n<p><img src=\"https://hackmd.io/_uploads/B188KC5yZg.png\" alt=\"image\"></p>\n<p><img src=\"https://hackmd.io/_uploads/HJM_t0qJZx.png\" alt=\"image\"></p>\n<p>You will then see <code>Signing succeeded</code></p>\n<h4 id=\"Signing-result\">Signing result</h4>\n<p><img src=\"https://hackmd.io/_uploads/ByIF9Rqk-g.png\" alt=\"image\"></p>\n<h4 id=\"Verify-signature-success\">Verify signature (success)</h4>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uv run model_signing verify bert-base-uncased --signature model.sig --identity &quot;your_signing_email@mail.com&quot; --identity_provider &quot;oidc_provider&quot;</span><br></pre></td></tr></table></figure>\n<p><strong>Common identity_providers include:</strong></p>\n<table>\n<thead>\n<tr>\n<th>identity_provider</th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Google</td>\n<td><code>https://accounts.google.com</code></td>\n</tr>\n<tr>\n<td>GitHub</td>\n<td><code>https://github.com/login/oauth</code></td>\n</tr>\n<tr>\n<td>GitHub Actions</td>\n<td><code>https://token.actions.githubusercontent.com</code></td>\n</tr>\n<tr>\n<td>Microsoft</td>\n<td><code>https://login.microsoftonline.com</code></td>\n</tr>\n</tbody>\n</table>\n<p><img src=\"https://hackmd.io/_uploads/S1PFtWs1Ze.png\" alt=\"image\"></p>\n<p>The signing originally used GitHub as the provider, so verification will fail if you change it to Google.</p>\n<h4 id=\"Verify-signature-failure\">Verify signature (failure)</h4>\n<p>Try modifying any character inside <code>model.sig</code>, for example delete the <code>M</code> in the <code>rawBytes</code> field so it becomes <code>IIC0zCCAlmgAwIBAgIUH.....</code></p>\n<p><img src=\"https://hackmd.io/_uploads/SkvJnbj1-x.png\" alt=\"image\"></p>\n<h1>üîÅ Recap</h1>\n<ul>\n<li>Introduced the 4 main pain points and application contexts that model signing aims to solve</li>\n<li>Detailed Sigstore‚Äôs three-layer format (Sigstore Bundle, DSSE Envelope, In-Toto Statement)</li>\n<li>Explained the meaning of various parameters in the code examples</li>\n<li>Performed actual model signing + verification (success and failure)</li>\n</ul>\n<h1>üîó References</h1>\n<ul>\n<li><a href=\"https://blog.csdn.net/gitblog_00061/article/details/142242122\">Sigstore Model Transparency È°πÁõÆÊïôÁ®ã</a></li>\n<li><a href=\"https://lfaidata.foundation/blog/2025/07/29/from-theory-to-practice-how-mlops-can-embed-genai-transparency/\">From Theory to Practice: How MLOps Can Embed GenAI Transparency</a></li>\n<li><a href=\"https://next.redhat.com/2025/04/10/model-authenticity-and-transparency-with-sigstore/\">Model authenticity and transparency with Sigstore</a></li>\n<li><a href=\"https://cloud.ibm.com/docs/hs-crypto?topic=hs-crypto-pkcs11-intro&amp;locale=zh-TW\">PKCS #11 -Ê®ôÊ∫ñÊñπÊ°àÁ∞°‰ªã</a></li>\n</ul>\n","_path":"/tutorial-sigstore.en/","_link":"https://hsiangjenli.github.io/blog/tutorial-sigstore.en/","_id":"cmixkzuok003gng5ncy4udyxz"}}