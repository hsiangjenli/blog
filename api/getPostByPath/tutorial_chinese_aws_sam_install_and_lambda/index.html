{"type":"getPostByPath","data":{"title":"[tutorial] ä½¿ç”¨ AWS SAM å»ºç«‹èˆ‡åŸ·è¡Œ Lambda å‡½æ•¸","date":"2025-06-19T16:00:00.000Z","description":"<h1>ğŸ“Œ Introduction</h1>\n<p>ä¸»è¦ä»‹ç´¹å¦‚ä½•ä½¿ç”¨ AWS SAM å»ºç«‹èˆ‡åŸ·è¡Œ Lambda å‡½æ•¸ï¼ŒåŒ…å«åŸºæœ¬å®‰è£ã€å°ˆæ¡ˆçµæ§‹èªªæ˜ï¼Œä»¥åŠåœ¨æœ¬åœ°ç«¯åŸ·è¡Œ Lambda çš„æ“ä½œæµç¨‹</p>","categories":[],"tags":[{"name":"aws","_id":"cmgpksfno000pnh3vgcqxcu56"},{"name":"lambda","_id":"cmgpksfoz004snh3v33tx55g3"}],"content":"<h1>ğŸ“Œ Introduction</h1>\n<p>ä¸»è¦ä»‹ç´¹å¦‚ä½•ä½¿ç”¨ AWS SAM å»ºç«‹èˆ‡åŸ·è¡Œ Lambda å‡½æ•¸ï¼ŒåŒ…å«åŸºæœ¬å®‰è£ã€å°ˆæ¡ˆçµæ§‹èªªæ˜ï¼Œä»¥åŠåœ¨æœ¬åœ°ç«¯åŸ·è¡Œ Lambda çš„æ“ä½œæµç¨‹</p>\n<span id=\"more\"></span>\n<h1>ğŸš€ Quick Start</h1>\n<h2 id=\"AWS-CLI\">AWS CLI</h2>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew install awscli</span><br></pre></td></tr></table></figure>\n<h2 id=\"AWS-SAM-Serverless-Application-Model-CLI\">AWS SAM (Serverless Application Model) CLI</h2>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew install aws-sam-cli</span><br></pre></td></tr></table></figure>\n<h3 id=\"åˆå§‹åŒ–-SAM-project\">åˆå§‹åŒ– SAM project</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sam init</span><br></pre></td></tr></table></figure>\n<h3 id=\"ä»‹ç´¹å°ˆæ¡ˆæ¶æ§‹\">ä»‹ç´¹å°ˆæ¡ˆæ¶æ§‹</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.</span><br><span class=\"line\">â”œâ”€â”€ __init__.py</span><br><span class=\"line\">â”œâ”€â”€ events</span><br><span class=\"line\">â”‚   â””â”€â”€ event.json</span><br><span class=\"line\">â”œâ”€â”€ hello_world</span><br><span class=\"line\">â”‚   â”œâ”€â”€ __init__.py</span><br><span class=\"line\">â”‚   â”œâ”€â”€ app.py</span><br><span class=\"line\">â”‚   â””â”€â”€ requirements.txt</span><br><span class=\"line\">â”œâ”€â”€ README.md</span><br><span class=\"line\">â”œâ”€â”€ samconfig.toml</span><br><span class=\"line\">â”œâ”€â”€ template.yaml</span><br><span class=\"line\">â””â”€â”€ tests</span><br><span class=\"line\">    â”œâ”€â”€ __init__.py</span><br><span class=\"line\">    â”œâ”€â”€ integration</span><br><span class=\"line\">    â”‚   â”œâ”€â”€ __init__.py</span><br><span class=\"line\">    â”‚   â””â”€â”€ test_api_gateway.py</span><br><span class=\"line\">    â”œâ”€â”€ requirements.txt</span><br><span class=\"line\">    â””â”€â”€ unit</span><br><span class=\"line\">        â”œâ”€â”€ __init__.py</span><br><span class=\"line\">        â””â”€â”€ test_handler.py</span><br></pre></td></tr></table></figure>\n<ul>\n<li><code>events/</code> - æ”¾ç½®æ¨¡æ“¬äº‹ä»¶ï¼ˆEvent Payloadï¼‰çš„ Json æª”ï¼Œç”¨ä¾†æ¸¬è©¦ Lambda å‡½æ•¸</li>\n<li><code>hello_world/</code> - Application çš„æ”¾ç½®è™•ï¼Œèˆ‡ Lambda æœ‰é—œçš„å‡½æ•¸ï¼ŒåŒ…å« handler å‡½å¼ï¼ˆä¾‹å¦‚ <a href=\"http://app.py\">app.py</a>ï¼‰ä»¥åŠä¾è³´ï¼ˆä¾‹å¦‚ requirements.txtï¼‰</li>\n<li><code>tests/</code> - å–®å…ƒæ¸¬è©¦çš„è³‡æ–™å¤¾</li>\n<li><code>samconfig.toml</code> - å„²å­˜ SAM CLI åŸ·è¡Œåƒæ•¸ï¼ˆå¦‚éƒ¨ç½²å€åŸŸã€Stack åç¨±ã€S3 bucket ç­‰ï¼‰ï¼Œç”¨ä¾†ç°¡åŒ– <code>sam deploy</code> æ™‚çš„è¨­å®šæµç¨‹</li>\n<li><code>template.yaml</code> - å®šç¾©æ‰€æœ‰ Lambda å‡½æ•¸ï¼ŒIaC çš„ä¸»è¦æ ¸å¿ƒæª”æ¡ˆï¼ˆä¸»è¦æœƒç”¨åˆ°å“ªäº›æœå‹™ï¼Œäº’ç›¸çš„ç›¸ä¾é—œä¿‚ï¼‰ï¼Œæ˜¯åŸºæ–¼ AWS CloudFormation çš„æ“´å……èªæ³•</li>\n</ul>\n<h4 id=\"template-yaml\"><code>template.yaml</code></h4>\n<blockquote>\n<p>å¯ä½¿ç”¨ CloudFormation Linter å·¥å…· <a href=\"https://github.com/aws-cloudformation/cfn-lint\"><code>cfn-lint</code></a> å°æª”æ¡ˆåµæ¸¬æ ¼å¼ã€å±¬æ€§éŒ¯èª¤</p>\n</blockquote>\n<p><strong>Header</strong></p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">AWSTemplateFormatVersion:</span> <span class=\"string\">&#x27;2010-09-09&#x27;</span></span><br><span class=\"line\"><span class=\"attr\">Transform:</span> <span class=\"string\">AWS::Serverless-2016-10-31</span></span><br><span class=\"line\"><span class=\"attr\">Description:</span> <span class=\"string\">&gt;</span></span><br><span class=\"line\">  <span class=\"string\">TODO....</span></span><br></pre></td></tr></table></figure>\n<ol>\n<li><strong>AWSTemplateFormatVersion</strong> - AWS CloudFormation çš„ç‰ˆæœ¬è™Ÿ</li>\n<li><strong>Transform</strong> - å‘Šè¨´ CloudFormation é€™å€‹æ¨¡æ¿è¦é¡å¤–ä½¿ç”¨ SAM ä¾†æ“´å……èªæ³•</li>\n<li><strong>Description</strong> - å°ˆæ¡ˆä»‹ç´¹</li>\n</ol>\n<p><strong>Content</strong></p>\n<ol>\n<li><strong>Globals</strong> - é è¨­è¨­å®šï¼Œæä¾›çµ¦ Resources ä½¿ç”¨</li>\n<li><strong>Resources</strong> - å»ºç«‹çš„ AWS è³‡æºï¼Œå¯åƒè€ƒ <a href=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/TemplateReference/aws-template-resource-type-ref.html\">AWS resource and property types reference</a>ã€<a href=\"https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/sam-specification-resources-and-properties.html\">AWS SAM resources and properties</a></li>\n<li><strong>Outputs</strong> - åœ¨éƒ¨ç½²å®Œå¾Œé æœŸå°å‡ºçš„çµæœï¼ˆä½ éœ€è¦çŸ¥é“å“ªäº›è³‡è¨Šï¼‰</li>\n</ol>\n<h4 id=\"samconfig-toml\"><code>samconfig.toml</code></h4>\n<blockquote>\n<p>å¯åƒè€ƒ <a href=\"https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/serverless-sam-cli-config.html\">AWS SAM CLI configuration file</a>ã€<a href=\"https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/using-sam-cli-configure.html\">Configuring the AWS SAM CLI</a>ã€<a href=\"https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/serverless-sam-cli-command-reference.html\">AWS SAM CLI command reference</a></p>\n</blockquote>\n<p>ç›®çš„æ˜¯ç‚ºäº†ç°¡åŒ–ä½¿ç”¨ sam æŒ‡ä»¤æ™‚çš„è¤‡é›œåº¦</p>\n<table>\n<thead>\n<tr>\n<th>Original</th>\n<th>Optimized with <code>samconfig</code></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>sam build --cached --parallel --use-containers</code></td>\n<td><code>sam build</code></td>\n</tr>\n<tr>\n<td><code>sam local invoke --env-vars locals.json</code></td>\n<td><code>sam local invoke</code></td>\n</tr>\n<tr>\n<td><code>sam local start-api --env-vars locals.json --warm-containers EAGER</code></td>\n<td><code>sam local start-api</code></td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"Local-Invoke\">Local Invoke</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sam local invoke</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">No current session found, using default AWS::AccountId                                                      </span><br><span class=\"line\">Invoking app.lambda_handler (python3.13)                                                                    </span><br><span class=\"line\">Local image is up-to-date                                                                                   </span><br><span class=\"line\">Using local image: public.ecr.aws/lambda/python:3.13-rapid-x86_64.                                          </span><br><span class=\"line\">                                                                                                            </span><br><span class=\"line\">Mounting /Users/XXXXXX/Documents/TEST/hello_world as </span><br><span class=\"line\">/var/task:ro,delegated, inside runtime container                                                            </span><br><span class=\"line\">START RequestId: f6a6ec50-58b2-432c-9381-ec45ca43b130 Version: $LATEST</span><br><span class=\"line\">END RequestId: e883464b-1216-43ae-b0fe-f7f803a73057</span><br><span class=\"line\">REPORT RequestId: e883464b-1216-43ae-b0fe-f7f803a73057  Init Duration: 1.26 ms  Duration: 381.91 ms     Billed Duration: 382 ms     Memory Size: 128 MB     Max Memory Used: 128 MB</span><br><span class=\"line\">&#123;&quot;statusCode&quot;: 200, &quot;body&quot;: &quot;&#123;\\&quot;message\\&quot;: \\&quot;hello world\\&quot;&#125;&quot;&#125;</span><br></pre></td></tr></table></figure>\n<h1>ğŸ” Recap</h1>\n<ul>\n<li>å®‰è£æŒ‡ä»¤</li>\n<li>ç†è§£ AWS SAM çš„å°ˆæ¡ˆæ¶æ§‹</li>\n<li>çŸ¥é“ç‰¹å®šæª”æ¡ˆ <code>template.yaml</code>ã€<code>samconfig.toml</code> æª”æ¡ˆç”¨é€”ä»¥åŠæ¬„ä½çš„å®˜æ–¹ç›¸é—œæ–‡ä»¶</li>\n<li>åœ¨åœ°ç«¯ Invoke ä¸€å€‹ç°¡å–®çš„ <code>Hello World</code> Lambda Function</li>\n</ul>\n<h1>ğŸ”— References</h1>\n<ul>\n<li><a href=\"https://ithelp.ithome.com.tw/articles/10214954\">Day02-ç’°å¢ƒæº–å‚™(ä¸€)å®‰è£AWS CLIã€Dockerã€AWS SAM CLI</a></li>\n</ul>\n","_path":"tutorial_chinese_aws_sam_install_and_lambda/","_link":"https://hsiangjenli.github.io/blog/tutorial_chinese_aws_sam_install_and_lambda/","_id":"cmgpksfom0034nh3v8z1qam4i"}}