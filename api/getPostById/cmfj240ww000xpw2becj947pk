{"type":"getPostById","data":{"title":"[教學] 使用 AWS SAM 建立與執行 Lambda 函數","date":"2025-06-19T16:00:00.000Z","description":"<h1>📌 介紹</h1>\n<p>本指南介紹如何使用 AWS SAM 建立與執行 Lambda 函數，包含基本安裝、專案結構說明，以及在本機執行 Lambda 的流程。</p>","categories":[],"tags":[{"name":"aws","_id":"cmfj240x50026pw2b87t6glre"},{"name":"lambda","_id":"cmfj240x60028pw2b9qqyc5c5"}],"content":"<h1>📌 介紹</h1>\n<p>本指南介紹如何使用 AWS SAM 建立與執行 Lambda 函數，包含基本安裝、專案結構說明，以及在本機執行 Lambda 的流程。</p>\n<span id=\"more\"></span>\n<h1>🚀 快速開始</h1>\n<h2 id=\"AWS-CLI\">AWS CLI</h2>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew install awscli</span><br></pre></td></tr></table></figure>\n<h2 id=\"AWS-SAM（Serverless-Application-Model）CLI\">AWS SAM（Serverless Application Model）CLI</h2>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew install aws-sam-cli</span><br></pre></td></tr></table></figure>\n<h3 id=\"初始化-SAM-專案\">初始化 SAM 專案</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sam init</span><br></pre></td></tr></table></figure>\n<h3 id=\"專案結構總覽\">專案結構總覽</h3>\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.</span><br><span class=\"line\">├── __init__.py</span><br><span class=\"line\">├── events</span><br><span class=\"line\">│   └── event.json</span><br><span class=\"line\">├── hello_world</span><br><span class=\"line\">│   ├── __init__.py</span><br><span class=\"line\">│   ├── app.py</span><br><span class=\"line\">│   └── requirements.txt</span><br><span class=\"line\">├── README.md</span><br><span class=\"line\">├── samconfig.toml</span><br><span class=\"line\">├── template.yaml</span><br><span class=\"line\">└── tests</span><br><span class=\"line\">    ├── __init__.py</span><br><span class=\"line\">    ├── integration</span><br><span class=\"line\">    │   ├── __init__.py</span><br><span class=\"line\">    │   └── test_api_gateway.py</span><br><span class=\"line\">    ├── requirements.txt</span><br><span class=\"line\">    └── unit</span><br><span class=\"line\">        ├── __init__.py</span><br><span class=\"line\">        └── test_handler.py</span><br></pre></td></tr></table></figure>\n<ul>\n<li><code>events/</code> - 包含用來測試 Lambda 函數的模擬事件有效載荷 JSON 檔案</li>\n<li><code>hello_world/</code> - 應用程式所在；Lambda 相關函數（例如 handler，例如 <a href=\"http://app.py\">app.py</a>）與相依套件（例如 requirements.txt）</li>\n<li><code>tests/</code> - 單元測試資料夾</li>\n<li><code>samconfig.toml</code> - 儲存 SAM CLI 執行參數（例如部署區域、stack 名稱、S3 桶等），以便在執行 <code>sam deploy</code> 時簡化設定</li>\n<li><code>template.yaml</code> - 定義所有 Lambda 函數；主要的基礎設施即程式碼（IaC）檔案（哪些服務被使用以及它們的相依性）。它是 AWS CloudFormation 語法的擴充。</li>\n</ul>\n<h4 id=\"template-yaml\"><code>template.yaml</code></h4>\n<blockquote>\n<p>您可以使用 CloudFormation Linter 工具 <a href=\"https://github.com/aws-cloudformation/cfn-lint\"><code>cfn-lint</code></a> 來偵測檔案中的格式與屬性錯誤</p>\n</blockquote>\n<p><strong>標頭</strong></p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">AWSTemplateFormatVersion:</span> <span class=\"string\">&#x27;2010-09-09&#x27;</span></span><br><span class=\"line\"><span class=\"attr\">Transform:</span> <span class=\"string\">AWS::Serverless-2016-10-31</span></span><br><span class=\"line\"><span class=\"attr\">Description:</span> <span class=\"string\">&gt;</span></span><br><span class=\"line\">  <span class=\"string\">TODO....</span></span><br></pre></td></tr></table></figure>\n<ol>\n<li><strong>AWSTemplateFormatVersion</strong> - AWS CloudFormation 的版本</li>\n<li><strong>Transform</strong> - 指示 CloudFormation 使用 SAM 擴充模板語法</li>\n<li><strong>Description</strong> - 專案描述</li>\n</ol>\n<p><strong>內容</strong></p>\n<ol>\n<li><strong>Globals</strong> - 提供給資源的預設設定</li>\n<li><strong>Resources</strong> - 要建立的 AWS 資源。請參閱 <a href=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/TemplateReference/aws-template-resource-type-ref.html\">AWS resource and property types reference</a> 與 <a href=\"https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/sam-specification-resources-and-properties.html\">AWS SAM resources and properties</a></li>\n<li><strong>Outputs</strong> - 部署後的預期輸出（您需要的資訊）</li>\n</ol>\n<h4 id=\"samconfig-toml\"><code>samconfig.toml</code></h4>\n<blockquote>\n<p>參見 <a href=\"https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/serverless-sam-cli-config.html\">AWS SAM CLI configuration file</a>、<a href=\"https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/using-sam-cli-configure.html\">Configuring the AWS SAM CLI</a>、<a href=\"https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/serverless-sam-cli-command-reference.html\">AWS SAM CLI command reference</a></p>\n</blockquote>\n<p>目的在於簡化使用 sam 指令時的複雜度</p>\n<table>\n<thead>\n<tr>\n<th>原本</th>\n<th>使用 <code>samconfig</code> 後</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>sam build --cached --parallel --use-containers</code></td>\n<td><code>sam build</code></td>\n</tr>\n<tr>\n<td><code>sam local invoke --env-vars locals.json</code></td>\n<td><code>sam local invoke</code></td>\n</tr>\n<tr>\n<td><code>sam local start-api --env-vars locals.json --warm-containers EAGER</code></td>\n<td><code>sam local start-api</code></td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"本機呼叫\">本機呼叫</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sam local invoke</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">No current session found, using default AWS::AccountId                                                       </span><br><span class=\"line\">Invoking app.lambda_handler (python3.13)                                                                    </span><br><span class=\"line\">Local image is up-to-date                                                                                  </span><br><span class=\"line\">Using local image: public.ecr.aws/lambda/python:3.13-rapid-x86_64.                                           </span><br><span class=\"line\">                                                                                                           </span><br><span class=\"line\">Mounting /Users/XXXXXX/Documents/TEST/hello_world as </span><br><span class=\"line\">/var/task:ro,delegated, inside runtime container                                                            </span><br><span class=\"line\">START RequestId: f6a6ec50-58b2-432c-9381-ec45ca43b130 Version: $LATEST</span><br><span class=\"line\">END RequestId: e883464b-1216-43ae-b0fe-f7f803a73057</span><br><span class=\"line\">REPORT RequestId: e883464b-1216-43ae-b0fe-f7f803a73057  Init Duration: 1.26 ms  Duration: 381.91 ms     Billed Duration: 382 ms     Memory Size: 128 MB     Max Memory Used: 128 MB</span><br><span class=\"line\">&#123;&quot;statusCode&quot;: 200, &quot;body&quot;: &quot;&#123;\\&quot;message\\&quot;: \\&quot;hello world\\&quot;&#125;&quot;&#125;</span><br></pre></td></tr></table></figure>\n<h1>🔁 重點回顧</h1>\n<ul>\n<li>安裝指令</li>\n<li>了解 AWS SAM 專案結構</li>\n<li>了解 <code>template.yaml</code> 與 <code>samconfig.toml</code> 這些檔案的用途及其相關官方文件</li>\n<li>在本機呼叫一個簡單的「Hello World」Lambda 函數</li>\n</ul>\n<h1>🔗 參考資料</h1>\n<ul>\n<li><a href=\"https://ithelp.ithome.com.tw/articles/10214954\">Day02-環境準備(一)安裝AWS CLI、Docker、AWS SAM CLI</a></li>\n</ul>\n","_path":"tutorial_chinese_aws_sam_install_and_lambda/","_link":"https://hsiangjenli.github.io/blog/tutorial_chinese_aws_sam_install_and_lambda/","_id":"cmfj240ww000xpw2becj947pk"}}