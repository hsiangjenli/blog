{"type":"getPostById","data":{"title":"[note] AWS é‡åˆ° InvalidToken æˆ–æ˜¯ InvalidClientTokenId","date":"2025-07-10T16:00:00.000Z","description":"<h1>ğŸ“Œ Introduction</h1>\n<p>ä½¿ç”¨ AWS CLI æ™‚ï¼Œè‹¥ MFA ç”¢ç”Ÿçš„ <code>AWS_SESSION_TOKEN</code> éæœŸï¼Œæœƒå°è‡´ <code>InvalidToken</code> æˆ– <code>InvalidClientTokenId</code> éŒ¯èª¤</p>","categories":[],"tags":[{"name":"aws","_id":"cmgpksfno000pnh3vgcqxcu56"}],"content":"<h1>ğŸ“Œ Introduction</h1>\n<p>ä½¿ç”¨ AWS CLI æ™‚ï¼Œè‹¥ MFA ç”¢ç”Ÿçš„ <code>AWS_SESSION_TOKEN</code> éæœŸï¼Œæœƒå°è‡´ <code>InvalidToken</code> æˆ– <code>InvalidClientTokenId</code> éŒ¯èª¤</p>\n<span id=\"more\"></span>\n<h1>ğŸš€ Quick Start</h1>\n<h2 id=\"å•é¡Œæè¿°\">å•é¡Œæè¿°</h2>\n<p>Token IDã€Secret éƒ½æ˜¯æ­£ç¢ºï¼Œå»åœ¨æ“ä½œæ™‚ç„¡æ³•é †åˆ©ç™»å…¥ï¼ˆInvalidTokenï¼‰</p>\n<h3 id=\"ä½¿ç”¨-aws-s3-ls-å‡ºç¾ä¸‹é¢éŒ¯èª¤\">ä½¿ç”¨ <code>aws s3 ls</code> å‡ºç¾ä¸‹é¢éŒ¯èª¤</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">An error occurred (InvalidToken) when calling the ListBuckets operation: The provided token is malformed or otherwise invalid.</span><br></pre></td></tr></table></figure>\n<h3 id=\"ä½¿ç”¨-aws-sts-get-session-token-ç”¢ç”Ÿ-Token-æ™‚å‡ºç¾ä¸‹é¢éŒ¯èª¤\">ä½¿ç”¨ <code>aws sts get-session-token</code> ç”¢ç”Ÿ Token æ™‚å‡ºç¾ä¸‹é¢éŒ¯èª¤</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">An error occurred (InvalidClientTokenId) when calling the GetSessionToken operation: The security token included in the request is invalid</span><br></pre></td></tr></table></figure>\n<h2 id=\"è§£æ±ºæ–¹æ³•\">è§£æ±ºæ–¹æ³•</h2>\n<p>æœƒç™¼ç”Ÿé€™é¡å‹å•é¡Œåœ¨æ–¼éå»æ›¾ç¶“ä½¿ç”¨é <code>AWS_SESSION_TOKEN</code>ï¼Œå¯èƒ½å·²ç¶“éæœŸå°è‡´ç„¡æ³•é †åˆ©ç™»å…¥ï¼Œè¦å…ˆ unset ä»¥ä¸‹åƒæ•¸</p>\n<!-- `~/.aws/credentials` -->\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">unset AWS_ACCESS_KEY_ID</span><br><span class=\"line\">unset AWS_SECRET_ACCESS_KEY</span><br><span class=\"line\">unset AWS_SESSION_TOKEN</span><br></pre></td></tr></table></figure>\n<h1>ğŸ” Recap</h1>\n<ul>\n<li>ä½¿ç”¨ AWS MFA é€²è¡Œç™»å…¥çš„ Session Token æœƒåœ¨éæœŸå¾Œç„¡æ³•ä½¿ç”¨</li>\n<li>éœ€è¦å…ˆæŠŠ <code>AWS_ACCESS_KEY_ID</code>ã€<code>AWS_SECRET_ACCESS_KEY</code>ã€<code>AWS_SESSION_TOKEN</code> å¾ç’°å¢ƒè®Šæ•¸ä¸­å»é™¤</li>\n</ul>\n<!-- - ç”±æ–¼ç•¶åˆä½¿ç”¨ä¸€æ¬¡æ€§ Token è¦†è“‹äº†ç™»å…¥æ†‘è­‰ï¼Œæ‰€ä»¥éœ€è¦ç¢ºèªç›®å‰çš„ `aws_access_key_id` ä»¥åŠ `aws_secret_access_key` æ˜¯å¦ç‚ºç•¶åˆåœ¨ AWS IAM ç”¢å‡ºçš„ Access Key -->\n<h1>ğŸ”— References</h1>\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/54837248/an-error-occurred-invalidtoken-when-calling-the-listbuckets-operation-the-pr\">An error occurred (InvalidToken) when calling the ListBuckets operation: The provided token is malformed or otherwise invalid. aws s3 ls</a></li>\n<li><a href=\"https://stackoverflow.com/questions/40198127/aws-cli-get-error-the-security-token-included-in-the-request-is-invalid\">aws cli get error â€œThe security token included in the request is invalidâ€</a></li>\n</ul>\n","_path":"note_aws_mfa_login_error/","_link":"https://hsiangjenli.github.io/blog/note_aws_mfa_login_error/","_id":"cmgpksfnt0016nh3v2496dvss"}}